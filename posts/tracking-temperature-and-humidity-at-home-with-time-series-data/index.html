<!doctype html><html lang=en dir=ltr class=scroll-smooth data-default-appearance=dark data-auto-appearance=true><head><meta charset=utf-8><meta http-equiv=content-language content="en"><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="ie=edge"><meta name=theme-color><title>Tracking Temperature and Humidity at Home with Time Series Data &#183; /misczak</title><meta name=title content="Tracking Temperature and Humidity at Home with Time Series Data &#183; /misczak"><meta name=description content="Generating temperature and humidity time series data and using MongoDB's time series collections, charts and window functions to analyze it."><meta name=keywords content="MongoDB,Raspberry Pi,Python,"><link rel=canonical href=https://www.misczak.com/posts/tracking-temperature-and-humidity-at-home-with-time-series-data/><meta name=author content="John Misczak"><link href=https://bsky.app/profile/misczak.com rel=me><link href=https://github.com/misczak rel=me><link href=https://www.linkedin.com/in/johnmisczak/ rel=me><meta property="og:url" content="https://www.misczak.com/posts/tracking-temperature-and-humidity-at-home-with-time-series-data/"><meta property="og:site_name" content="/misczak"><meta property="og:title" content="Tracking Temperature and Humidity at Home with Time Series Data"><meta property="og:description" content="Generating temperature and humidity time series data and using MongoDB's time series collections, charts and window functions to analyze it."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-05-30T00:00:00+00:00"><meta property="article:modified_time" content="2022-05-30T00:00:00+00:00"><meta property="article:tag" content="MongoDB"><meta property="article:tag" content="Raspberry Pi"><meta property="article:tag" content="Python"><meta property="og:image" content="https://www.misczak.com/posts/tracking-temperature-and-humidity-at-home-with-time-series-data/featured.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://www.misczak.com/posts/tracking-temperature-and-humidity-at-home-with-time-series-data/featured.png"><meta name=twitter:title content="Tracking Temperature and Humidity at Home with Time Series Data"><meta name=twitter:description content="Generating temperature and humidity time series data and using MongoDB's time series collections, charts and window functions to analyze it."><link type=text/css rel=stylesheet href=/css/main.bundle.min.f41394a5c0e10c1cf8a65888f77e21ec279d86842cd26f2d94fc9956dfaa3240ba32a773ef895535ec8fa317a1eeeaeeecb64add401d2082d37bf1031716a0f9.css integrity="sha512-9BOUpcDhDBz4pliI934h7CedhoQs0m8tlPyZVt+qMkC6Mqdz74lVNeyPoxeh7uru7LZK3UAdIILTe/EDFxag+Q=="><script type=text/javascript src=/js/appearance.min.6f41174b3a05b680820fe08cadbfa5fb7a7ca347b76a0955cdc68b9d8aca1ce24f0547e138cea33bcc7904d551a90afcb1cc7f2d9fe8557075d501419046c08c.js integrity="sha512-b0EXSzoFtoCCD+CMrb+l+3p8o0e3aglVzcaLnYrKHOJPBUfhOM6jO8x5BNVRqQr8scx/LZ/oVXB11QFBkEbAjA=="></script><script src=/lib/zoom/zoom.min.umd.a527109b68c082a70f3697716dd72a9d5aa8b545cf800cecbbc7399f2ca6f6e0ce3e431f2062b48bbfa47c9ea42822714060bef309be073f49b9c0e30d318d7b.js integrity="sha512-pScQm2jAgqcPNpdxbdcqnVqotUXPgAzsu8c5nyym9uDOPkMfIGK0i7+kfJ6kKCJxQGC+8wm+Bz9JucDjDTGNew=="></script><script defer type=text/javascript id=script-bundle src=/js/main.bundle.min.f9fe268fcd89dff326e0b5bf1183a8dd1c1ec5059292635b1eed4e4ed7b35aa272234cecb245d91be3e1b7fd9403e6e5cfcdd7d5a4fcb2c8ba11deb4b81dadd2.js integrity="sha512-+f4mj82J3/Mm4LW/EYOo3RwexQWSkmNbHu1OTtezWqJyI0zsskXZG+Pht/2UA+blz83X1aT8ssi6Ed60uB2t0g==" data-copy=Copy data-copied=Copied></script><script src=/lib/jquery/jquery.slim.min.b0dca576e87d7eaa5850ae4e61759c065786cdb6489d68fcc82240539eebd5da522bdb4fda085ffd245808c8fe2acb2516408eb774ef26b5f6015fc6737c0ea8.js integrity="sha512-sNylduh9fqpYUK5OYXWcBleGzbZInWj8yCJAU57r1dpSK9tP2ghf/SRYCMj+KsslFkCOt3TvJrX2AV/Gc3wOqA=="></script><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><script type=application/ld+json>[{"@context":"https://schema.org","@type":"Article","articleSection":"Posts","name":"Tracking Temperature and Humidity at Home with Time Series Data","headline":"Tracking Temperature and Humidity at Home with Time Series Data","description":"Generating temperature and humidity time series data and using MongoDB\u0027s time series collections, charts and window functions to analyze it.","inLanguage":"en","url":"https://www.misczak.com/posts/tracking-temperature-and-humidity-at-home-with-time-series-data/","author":{"@type":"Person","name":"John Misczak"},"copyrightYear":"2022","dateCreated":"2022-05-30T00:00:00\u002b00:00","datePublished":"2022-05-30T00:00:00\u002b00:00","dateModified":"2022-05-30T00:00:00\u002b00:00","keywords":["MongoDB","Raspberry Pi","Python"],"mainEntityOfPage":"true","wordCount":"2061"}]</script></head><body class="flex flex-col h-screen m-auto leading-7 max-w-7xl px-6 sm:px-14 md:px-24 lg:px-32 text-lg bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600"><div id=the-top class="absolute flex self-center"><a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600" href=#main-content><span class="font-bold text-primary-600 pe-2 dark:text-primary-400">&darr;</span>
Skip to main content</a></div><div class="main-menu flex items-center justify-between py-6 md:justify-start gap-x-3 pt-[2px] pr-2 md:pr-4 pb-[3px] pl-0"><div class="flex flex-1 items-center justify-between"><nav class="flex space-x-3"><a href=/ class="text-base font-medium">/misczak</a></nav><nav class="hidden md:flex items-center gap-x-5 md:ml-12 h-12"><a href=/posts/ class="flex items-center hover:text-primary-600 dark:hover:text-primary-400" aria-label=Blog title=Posts><p class="text-base font-medium">Blog</p></a><a href=/about/ class="flex items-center hover:text-primary-600 dark:hover:text-primary-400" aria-label=About title><p class="text-base font-medium">About</p></a><a href class="flex items-center hover:text-primary-600 dark:hover:text-primary-400" title></a><button id=search-button aria-label=Search class="text-base hover:text-primary-600 dark:hover:text-primary-400" title="Search (/)">
<span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></button><div class="flex items-center"><button id=appearance-switcher aria-label="Dark mode switcher" type=button class="text-base hover:text-primary-600 dark:hover:text-primary-400"><div class="flex items-center justify-center dark:hidden"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg></span></div><div class="items-center justify-center hidden dark:flex"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg></span></div></button></div></nav><div class="flex md:hidden items-center gap-x-5 md:ml-12 h-12"><span></span>
<button id=search-button-mobile aria-label=Search class="text-base hover:text-primary-600 dark:hover:text-primary-400" title="Search (/)">
<span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span></button>
<button id=appearance-switcher-mobile aria-label="Dark mode switcher" type=button class="text-base hover:text-primary-600 dark:hover:text-primary-400 me-1"><div class="flex items-center justify-center dark:hidden"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg></span></div><div class="items-center justify-center hidden dark:flex"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg></span></div></button></div></div><div class="-my-2 md:hidden"><div id=menu-button class=block><div class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400"><span class="relative block icon"><svg viewBox="0 0 448 512"><path fill="currentColor" d="M0 96C0 78.33 14.33 64 32 64H416c17.7.0 32 14.33 32 32 0 17.7-14.3 32-32 32H32C14.33 128 0 113.7.0 96zM0 256c0-17.7 14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32H32c-17.67.0-32-14.3-32-32zM416 448H32c-17.67.0-32-14.3-32-32s14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32z"/></svg></span></div><div id=menu-wrapper class="fixed inset-0 z-30 invisible w-screen h-screen m-0 overflow-auto transition-opacity opacity-0 cursor-default bg-neutral-100/50 backdrop-blur-sm dark:bg-neutral-900/50 pt-[5px]"><ul class="flex space-y-2 mt-3 flex-col items-end w-full px-6 py-6 mx-auto overflow-visible list-none text-end max-w-7xl"><li id=menu-close-button><span class="cursor-pointer inline-block align-text-bottom hover:text-primary-600 dark:hover:text-primary-400"><span class="relative block icon"><svg viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></span></li><li class=mt-1><a href=/posts/ class="flex items-center hover:text-primary-600 dark:hover:text-primary-400" aria-label=Blog title=Posts><p class="text-bg font-bg">Blog</p></a></li><li class=mt-1><a href=/about/ class="flex items-center hover:text-primary-600 dark:hover:text-primary-400" aria-label=About title><p class="text-bg font-bg">About</p></a></li><li class=mt-1><a href class="flex items-center hover:text-primary-600 dark:hover:text-primary-400" title></a></li></ul></div></div></div></div><div class="relative flex flex-col grow"><main id=main-content class=grow><article><header id=single_header class="mt-5 max-w-prose"><ol class="text-sm text-neutral-500 dark:text-neutral-400 print:hidden"><li class=hidden><a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href=/>/misczak</a><span class="px-1 text-primary-500">/</span></li><li class=inline><a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href=/posts/>Posts</a><span class="px-1 text-primary-500">/</span></li><li class=hidden><a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href=/posts/tracking-temperature-and-humidity-at-home-with-time-series-data/>Tracking Temperature and Humidity at Home with Time Series Data</a><span class="px-1 text-primary-500">/</span></li></ol><h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">Tracking Temperature and Humidity at Home with Time Series Data</h1><div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden"><div class="flex flex-row flex-wrap items-center"><time datetime=2022-05-30T00:00:00+00:00>30 May 2022</time><span class="px-2 text-primary-500">&#183;</span><span>2061 words</span><span class="px-2 text-primary-500">&#183;</span><span title="Reading time">10 mins</span></div></div><div class="flex author"><img class="!mt-0 !mb-0 h-24 w-24 rounded-full me-4" width=96 height=96 alt="John Misczak" src=/author_hu_16dc406033739085.jpg data-zoom-src=/author_hu_e6186a32d99662da.jpg><div class=place-self-center><div class="text-[0.6rem] uppercase leading-3 text-neutral-500 dark:text-neutral-400">Author</div><div class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300">John Misczak</div><div class="text-sm text-neutral-700 dark:text-neutral-400">Security Engineer in Philadelphia</div><div class="text-2xl sm:text-lg"><div class="flex flex-wrap text-neutral-400 dark:text-neutral-500"><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://bsky.app/profile/misczak.com target=_blank aria-label=Bluesky title=Bluesky rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M256 232.562c-21.183-41.196-78.868-117.97-132.503-155.834-51.378-36.272-70.978-29.987-83.828-24.181-14.872 6.72-17.577 29.554-17.577 42.988.0 13.433 7.365 110.138 12.169 126.281 15.873 53.336 72.376 71.358 124.413 65.574 2.66-.395 5.357-.759 8.089-1.097-2.68.429-5.379.796-8.089 1.097-76.259 11.294-143.984 39.085-55.158 137.972C201.224 526.527 237.424 403.67 256 341.379c18.576 62.291 39.972 180.718 150.734 83.983 83.174-83.983 22.851-126.674-53.408-137.969-2.71-.302-5.409-.667-8.089-1.096 2.732.337 5.429.702 8.089 1.096 52.037 5.785 108.54-12.239 124.413-65.574 4.804-16.142 12.169-112.847 12.169-126.281.0-13.434-2.705-36.267-17.577-42.988-12.85-5.806-32.45-12.09-83.829 24.181C334.868 114.595 277.183 191.366 256 232.562z"/></svg></span></span></a>
<a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://github.com/misczak target=_blank aria-label=Github title=Github rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
</span></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://www.linkedin.com/in/johnmisczak/ target=_blank aria-label=Linkedin title=Linkedin rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 448 512"><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5.0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6.0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3.0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2.0 38.5 17.3 38.5 38.5.0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6.0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2.0 79.7 44.3 79.7 101.9V416z"/></svg></span></span></a></div></div></div></div><div class=mb-5></div></header><section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row"><div class="order-first lg:ml-auto px-0 lg:order-last lg:ps-8 lg:max-w-2xs"><div class="toc ps-5 print:hidden lg:sticky lg:top-10"><details open id=TOCView class="toc-right mt-0 overflow-y-auto overscroll-contain scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600 rounded-lg -ms-5 ps-5 pe-2 hidden lg:block"><summary class="block py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 -ms-5 ps-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">Table of Contents</summary><div class="min-w-[220px] py-2 border-dotted border-s-1 -ms-5 ps-5 dark:border-neutral-600"><nav id=TableOfContents><ul><li><a href=#background>Background</a></li><li><a href=#acquiring-the-hardware>Acquiring the Hardware</a></li><li><a href=#booting-the-pi>Booting the Pi</a></li><li><a href=#creating-the-time-series-database>Creating the Time Series Database</a></li><li><a href=#scripting-data-collection>Scripting Data Collection</a></li><li><a href=#using-mongodb-charts-to-visualize-the-data>Using MongoDB Charts to Visualize the Data</a></li></ul></nav></div></details><details class="toc-inside mt-0 overflow-hidden rounded-lg -ms-5 ps-5 lg:hidden"><summary class="py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 -ms-5 ps-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">Table of Contents</summary><div class="py-2 border-dotted border-neutral-300 border-s-1 -ms-5 ps-5 dark:border-neutral-600"><nav id=TableOfContents><ul><li><a href=#background>Background</a></li><li><a href=#acquiring-the-hardware>Acquiring the Hardware</a></li><li><a href=#booting-the-pi>Booting the Pi</a></li><li><a href=#creating-the-time-series-database>Creating the Time Series Database</a></li><li><a href=#scripting-data-collection>Scripting Data Collection</a></li><li><a href=#using-mongodb-charts-to-visualize-the-data>Using MongoDB Charts to Visualize the Data</a></li></ul></nav></div></details></div></div><div class="min-w-0 min-h-0 max-w-fit"><div class="article-content max-w-prose mb-20"><p>Disclaimer: I am a MongoDB employee.</p><h2 class="relative group">Background<div id=background class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#background aria-label=Anchor>#</a></span></h2><p>Several years back, I received a Raspberry Pi 3 Model B+ kit from <a href=https://www.canakit.com/ target=_blank>CanaKit</a> alongside <a href=https://amzn.to/3wPWOMI target=_blank>this book</a>. I spent some time doing the basic stuff with it (blinking LEDs, running a Linux server, etc.) but eventually turning it into a <a href=https://retropie.org.uk/ target=_blank>RetroPie</a> and installing lots of retro games on it. After a while, I lost interest in tinkering with it and just let it collect dust in my office for a number of years.</p><p>I was recently cleaning out my office and rediscovered both the old RaspberryPi and the book, and was thumbing through the projects when I noticed one that caught my eye. Listed in the book as Project 12, it&rsquo;s a simple temperature and humidity data logger that didn&rsquo;t really draw my interest a few years ago. Since then, however, I&rsquo;ve moved to a new place where the bedrooms are essentially on the third floor (making them much warmer than the rest of the house). Because of this setup, one of the things that my wife and I constantly ask each other is how warm or cold it is in my son&rsquo;s nursery compared to the downstairs portions of the house. With this in mind, I decided to see if I could combine this simple Raspberry Pi project with the new <a href=https://www.mongodb.com/developer/products/mongodb/new-time-series-collections/ target=_blank>Time Series collections</a> that MongoDB offers starting with version 5.0. The idea was to make a tool that would display the current conditions of my son&rsquo;s nursery while also giving me the ability to show how the conditions changed throughout the day and look for patterns if I felt the need to do so.</p><h2 class="relative group">Acquiring the Hardware<div id=acquiring-the-hardware class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#acquiring-the-hardware aria-label=Anchor>#</a></span></h2><p>To build the temperature and humidity sensor, the book lists the following components:</p><ul><li>Raspberry Pi (obviously)</li><li>Breadboard</li><li>DHT22 temperature and humidity sensor (can substitute DHT11 or AM2302 as well)</li><li>4.7k ohm resistor</li><li>Jumper wires</li></ul><p>That&rsquo;s not an overwhelming number of components, but it&rsquo;s still a bunch of pieces that will make for a pretty messy package if you&rsquo;re trying to leave it somewhere in a discreet manner. You would have to connect GND on the Pi to the breadboard&rsquo;s blue rail, 3.3V on the Pi to the breadboard&rsquo;s red rail, and then connect the sensor to the breadboard and Pi as well, using the resistor on the 3.3V connection for DHT22 pin 2.</p><p>Instead, I found <a href=https://thepihut.com/products/dht22-temperature-humidity-sensor target=_blank>this DHT22 sensor</a> that comes with a handy 3-pin wire that you can plug directly into the Pi. DOUT goes to GPIO (pin 4) on the Pi, VCC goes to pin 1 on the Pi, and GND goes to pin 6 on the Pi. Using the case that came with my Pi from CanaKit, I was able to enclose the Pi and just had the wires escape out the top to the sensor, greatly cleaning up the overall appearance.</p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt="The enclosed Raspberry Pi and DHT22 sensor" width=999 height=749 src=/posts/tracking-temperature-and-humidity-at-home-with-time-series-data/images/rpi_hu_8d34f2477aae1e2.png srcset="/posts/tracking-temperature-and-humidity-at-home-with-time-series-data/images/rpi_hu_8d34f2477aae1e2.png 800w, /posts/tracking-temperature-and-humidity-at-home-with-time-series-data/images/rpi.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/posts/tracking-temperature-and-humidity-at-home-with-time-series-data/images/rpi.png></figure><h2 class="relative group">Booting the Pi<div id=booting-the-pi class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#booting-the-pi aria-label=Anchor>#</a></span></h2><p>This was by far the easiest part of this project. The <a href=https://www.raspberrypi.com/software/ target=_blank>Raspberry Pi OS</a> (formerly known as Raspbian) gives you an easy to use Linux OS. Better yet, the <a href="https://www.youtube.com/watch?v=ntaXWS8Lk34" target=_blank>Imager utility</a> helps you set up your install so it will work exactly the way you want right out of the box. You can setup a user for SSH so once it powers up, you can connect directly to it in a headless fashion. Once you have your Pi booted up and are able to SSH into it, the real work begins.</p><h2 class="relative group">Creating the Time Series Database<div id=creating-the-time-series-database class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#creating-the-time-series-database aria-label=Anchor>#</a></span></h2><p>We&rsquo;ll be using the Time Series collections feature of MongoDB 5.0. The easiest way to get started is to spin up a <a href=https://www.mongodb.com/docs/atlas/tutorial/deploy-free-tier-cluster/ target=_blank>free tier cluster on MongoDB Atlas</a> and then connect in with the new mongo shell, <a href=https://www.mongodb.com/docs/mongodb-shell/ target=_blank>mongosh</a>. You&rsquo;ll also want to make sure you create a database user with credentials that the script can use to connect to the database, as well as add an entry on the IP Access List to allow the connection in the first place.</p><p>Once connected to your cluster through <code>mongosh</code>, you&rsquo;ll want to create the time series collection as follows:</p><div class=highlight-wrapper><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>use ts
</span></span><span class=line><span class=cl>db.createCollection<span class=o>(</span><span class=s2>&#34;homeclimate&#34;</span>, <span class=o>{</span> 
</span></span><span class=line><span class=cl>    timeseries: <span class=o>{</span> 
</span></span><span class=line><span class=cl>        timeField: <span class=s2>&#34;timestamp&#34;</span>, 
</span></span><span class=line><span class=cl>        metaField: <span class=s2>&#34;metadata&#34;</span>, 
</span></span><span class=line><span class=cl>        granularity: <span class=s2>&#34;seconds&#34;</span> 
</span></span><span class=line><span class=cl>    <span class=o>}</span>, expireAfterSeconds: <span class=m>604800</span> 
</span></span><span class=line><span class=cl>    <span class=o>}</span> <span class=o>)</span></span></span></code></pre></div></div><p>The above command does the following:</p><ul><li>Creates a time series collection called &lsquo;homeclimate&rsquo; in the &rsquo;ts&rsquo; database</li><li>Establishes a granularity of seconds for document ingestion</li><li>Tells MongoDB that the &rsquo;timestamp&rsquo; field will be used to represent the time of each reading, and the &lsquo;metadata&rsquo; field will hold the information used to identify where the reading is coming from (such as what sensor)</li><li>Makes documents in this collection expire after 604800 seconds or a little over 7 days, as we don&rsquo;t want to pay for an ever increasing data size and any data older than that is probably of low analytical value</li></ul><h2 class="relative group">Scripting Data Collection<div id=scripting-data-collection class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#scripting-data-collection aria-label=Anchor>#</a></span></h2><p>The projects book linked to the <a href=https://github.com/adafruit/Adafruit_Python_DHT target=_blank>Adafruit Python DHT library</a> but if you go to the Github repo, you&rsquo;ll see that it&rsquo;s deprecated. The new version is <a href=https://github.com/adafruit/Adafruit_CircuitPython_DHT target=_blank>CircuitPython</a> which can be easily installed on the Raspberry Pi OS using pip:</p><div class=highlight-wrapper><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>pip3 install adafruit-circuitpython-dht</span></span></code></pre></div></div><p>From there, it&rsquo;s time to actually start pulling data from the sensor with a continuously running script. Create a new Python script and edit it (I recommend using Visual Studio Code in Remote Mode to make this easier) to contain the following:</p><div class=highlight-wrapper><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>time</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>board</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>adafruit_dht</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>datetime</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pymongo</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Initial the dht device, with data pin connected to:</span>
</span></span><span class=line><span class=cl><span class=n>dhtDevice</span> <span class=o>=</span> <span class=n>adafruit_dht</span><span class=o>.</span><span class=n>DHT22</span><span class=p>(</span><span class=n>board</span><span class=o>.</span><span class=n>D4</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Set up python client for MongoDB</span>
</span></span><span class=line><span class=cl><span class=n>client</span> <span class=o>=</span> <span class=n>pymongo</span><span class=o>.</span><span class=n>MongoClient</span><span class=p>(</span><span class=o>&lt;</span><span class=n>MONGODB</span> <span class=n>CONNECTION</span> <span class=n>STRING</span><span class=o>&gt;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>db</span> <span class=o>=</span> <span class=n>client</span><span class=o>.</span><span class=n>ts</span>
</span></span><span class=line><span class=cl><span class=n>collection</span> <span class=o>=</span> <span class=n>db</span><span class=o>.</span><span class=n>homeclimate</span>
</span></span><span class=line><span class=cl><span class=n>sensor</span> <span class=o>=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># Pull the values right from the sensor device</span>
</span></span><span class=line><span class=cl>        <span class=n>temperature_c</span> <span class=o>=</span> <span class=n>dhtDevice</span><span class=o>.</span><span class=n>temperature</span>
</span></span><span class=line><span class=cl>        <span class=n>temperature_f</span> <span class=o>=</span> <span class=n>temperature_c</span> <span class=o>*</span> <span class=p>(</span><span class=mi>9</span> <span class=o>/</span> <span class=mi>5</span><span class=p>)</span> <span class=o>+</span> <span class=mi>32</span>
</span></span><span class=line><span class=cl>        <span class=n>humidity</span> <span class=o>=</span> <span class=n>dhtDevice</span><span class=o>.</span><span class=n>humidity</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># Write a document with the temperature and humidity to the time series collection</span>
</span></span><span class=line><span class=cl>        <span class=n>document</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&#34;metadata&#34;</span><span class=p>:</span> <span class=p>{</span><span class=s2>&#34;sensorId&#34;</span><span class=p>:</span> <span class=n>sensor</span><span class=p>,</span> <span class=s2>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;climate&#34;</span><span class=p>},</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;timestamp&#34;</span><span class=p>:</span> <span class=n>datetime</span><span class=o>.</span><span class=n>datetime</span><span class=o>.</span><span class=n>utcnow</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;temperature_fahrenheit&#34;</span><span class=p>:</span> <span class=n>temperature_f</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;temperature_celsius&#34;</span><span class=p>:</span> <span class=n>temperature_c</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;humidity&#34;</span><span class=p>:</span> <span class=n>humidity</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>doc_id</span> <span class=o>=</span> <span class=n>collection</span><span class=o>.</span><span class=n>insert_one</span><span class=p>(</span><span class=n>document</span><span class=p>)</span><span class=o>.</span><span class=n>inserted_id</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Recorded reading to document </span><span class=si>{}</span><span class=s2>&#34;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>doc_id</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=n>time</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=mi>10</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>RuntimeError</span> <span class=k>as</span> <span class=n>error</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># Errors will happen but need to keep going. Can make up for missed readings </span>
</span></span><span class=line><span class=cl>        <span class=c1># in the Time Series collection</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=n>error</span><span class=o>.</span><span class=n>args</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        <span class=n>time</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=mf>2.0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>continue</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>error</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>dhtDevice</span><span class=o>.</span><span class=n>exit</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=k>raise</span> <span class=n>error</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>time</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=mf>10.0</span><span class=p>)</span></span></span></code></pre></div></div><p>There&rsquo;s a few things going on in this script:</p><ol><li>First, we&rsquo;re setting up the actual sensor by using the driver to build a device object and saying its connected on pin 4 (GPIO) on the Raspberry Pi.</li><li>We&rsquo;re creating a connection to our MongoDB cluster and specifying the database and collection we&rsquo;ll be storing data in. We also setup this sensor&rsquo;s identifier. Since this was my first sensor, I gave it a sensor ID of 1. Future sensors will increment this value.</li><li>In a infinite while loop, we grab the temperature and humidity values from the sensor. Since I live in the US, I also convert this temperature to farenheit and put both temperature values alongside with humidity into a MongoDB document. Since we&rsquo;re using a Time Series collection, I have an embedded document with my metadata values - a sensorID and a sensor type that may come in handy in the future as I scale these out. The only other value in the document is the current UTC timestamp, which is critical for helping build the time series view.</li><li>After taking the reading and writing it to the database, we wait ten seconds until we do it again. This time can be adjusted up or down depending on how granular you want your time series data to be.</li></ol><p>If you&rsquo;ve configured your MongoDB connection string correctly and added the entry in the IP Access List in Atlas, running this script should start writing to your Time Series collection. You should see the results after just a few seconds by going to the Collections view in Atlas:</p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt="Documents populating the time series collection" width=1978 height=1015 src=/posts/tracking-temperature-and-humidity-at-home-with-time-series-data/images/tscollectionview_hu_4a54ab6346868192.png srcset="/posts/tracking-temperature-and-humidity-at-home-with-time-series-data/images/tscollectionview_hu_4a54ab6346868192.png 800w, /posts/tracking-temperature-and-humidity-at-home-with-time-series-data/images/tscollectionview_hu_c257aa2a216d104b.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/posts/tracking-temperature-and-humidity-at-home-with-time-series-data/images/tscollectionview.png></figure><h2 class="relative group">Using MongoDB Charts to Visualize the Data<div id=using-mongodb-charts-to-visualize-the-data class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#using-mongodb-charts-to-visualize-the-data aria-label=Anchor>#</a></span></h2><p>Now that the readings are coming into MongoDB, you can use the Charts feature of MongoDB Atlas to create a dashboard and display useful information and visualizations derived from the raw data. Start by clicking on the <strong>Charts</strong> tab at the top of MongoDB Atlas, then select <strong>Data Sources</strong> in the left hand menu. On that page, click the <strong>Add Data Source</strong> button in the upper right and then select your cluster. It should only have one database - <code>ts</code> - and one collection - <code>homeclimate</code>. Select those and click <strong>Finish</strong> to set up the data source.</p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt="Using the time series collection as a Charts data source" width=1418 height=734 src=/posts/tracking-temperature-and-humidity-at-home-with-time-series-data/images/chartsdatasource_hu_d65932879609d192.png srcset="/posts/tracking-temperature-and-humidity-at-home-with-time-series-data/images/chartsdatasource_hu_d65932879609d192.png 800w, /posts/tracking-temperature-and-humidity-at-home-with-time-series-data/images/chartsdatasource_hu_8d0477a941c4b1d7.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/posts/tracking-temperature-and-humidity-at-home-with-time-series-data/images/chartsdatasource.png></figure><p>Now that the time series collection shows up in the Data Sources list, look to the <em>Pipeline</em> column near the right hand side. Click the <strong>Add Pipeline</strong> button. We&rsquo;re going to use the <a href=https://www.mongodb.com/docs/manual/reference/operator/aggregation/setWindowFields/ target=_blank>$setWindowFields</a> aggregation operator to build a window function on the time series collection; specifically, we&rsquo;re going to run a calculation on only the readings from the last hour.</p><p>Inside the Aggregation Pipeline Edit modal that appears, paste in the following pipeline:</p><div class=highlight-wrapper><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=p>[</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span><span class=nx>$setWindowFields</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>partitionBy</span><span class=o>:</span> <span class=s2>&#34;$metadata.sensorId&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>sortBy</span><span class=o>:</span> <span class=p>{</span> <span class=nx>timestamp</span><span class=o>:</span> <span class=mi>1</span><span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=nx>output</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>lastHourAverageTemp</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>$avg</span><span class=o>:</span> <span class=s2>&#34;$temperature_fahrenheit&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nb>window</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=nx>documents</span><span class=o>:</span> <span class=p>[</span><span class=o>-</span><span class=mi>360</span><span class=p>,</span> <span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=p>},</span>
</span></span><span class=line><span class=cl>      <span class=nx>lastHourAverageHumidity</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>$avg</span><span class=o>:</span> <span class=s2>&#34;$humidity&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nb>window</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=nx>documents</span><span class=o>:</span> <span class=p>[</span><span class=o>-</span><span class=mi>360</span><span class=p>,</span> <span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span> <span class=p>]</span></span></span></code></pre></div></div><p>This window function creates two new fields for us to use in MongoDB Charts - the <code>lastHourAverageTemp</code> and <code>lastHourAverageHumidity</code>. Note that I used the original Fahrenheit temperature as the source for this new average temperature field - depending on where you&rsquo;re located, you may want to swap in Celsius instead. Since we&rsquo;re collecting readings every 10 seconds in our original script, we go back 360 readings (6 readings a minute multipled by 60 minutes in an hour). Click <strong>Save</strong> when you&rsquo;ve pasted this in.</p><p>Now click on <strong>Dashboards</strong> on the left hand navigation, then select the <strong>Add Dashboard</strong> button on the far right. Call the dashboard whatever you want. Once it&rsquo;s open, we&rsquo;ll have to add some charts. Click on Add Chart and you&rsquo;ll be brought to the MongoDB Charts editor. If you&rsquo;ve never used it before, I recommend checking out the <a href=https://www.mongodb.com/docs/charts/ target=_blank>Charts documentation</a> to check out all the features it has.</p><p>For now, we&rsquo;re going to add a simple chart to display the current temperature. In the upper left under data source, select <strong>ts.homeclimate</strong> which should be the only option available. Choose <strong>Text</strong> as the <em>Chart Type</em>, then select <strong>Top Item</strong> as want the most recent temperature reading. Now drag &rsquo;timestamp&rsquo; to the <em>Sort</em> field placeholder, and click the sort button to the right of it to make sure it&rsquo;s in descending order. Drag <code>temperature_fahrenheit</code> to the <em>Display</em> field placeholder and you should now get the most recent reading&rsquo;s Fahrenheit temperature value. Click <strong>Save and Close</strong> at the top.</p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt="The Current Temperature Chart Configuration" width=1515 height=1002 src=/posts/tracking-temperature-and-humidity-at-home-with-time-series-data/images/currenttemp_hu_6203f4b160bb5418.png srcset="/posts/tracking-temperature-and-humidity-at-home-with-time-series-data/images/currenttemp_hu_6203f4b160bb5418.png 800w, /posts/tracking-temperature-and-humidity-at-home-with-time-series-data/images/currenttemp_hu_f673f158ce5dda16.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/posts/tracking-temperature-and-humidity-at-home-with-time-series-data/images/currenttemp.png></figure><p>Now we can add another chart and do the same exact thing, but instead of the regular &rsquo;temperature_fahrenheit&rsquo; field being used as the reading, we can use the &rsquo;lastHourAverageTemp&rsquo; field that was added via the pipeline we attached to the data source. This will give us a view of the average temperature of the last hour in case the most recent temperature becomes an outlier, like if someone opens a window or starts running a heater.</p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt="The Last Hour Average Temperature Chart Configuration" width=1749 height=1044 src=/posts/tracking-temperature-and-humidity-at-home-with-time-series-data/images/averagetemp_hu_111a7f8d93f0759c.png srcset="/posts/tracking-temperature-and-humidity-at-home-with-time-series-data/images/averagetemp_hu_111a7f8d93f0759c.png 800w, /posts/tracking-temperature-and-humidity-at-home-with-time-series-data/images/averagetemp_hu_cfe263f9eb2d8afd.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/posts/tracking-temperature-and-humidity-at-home-with-time-series-data/images/averagetemp.png></figure><p>Then we can add a third chart to visualize the change in temperature over time from the sensor. Add a new chart and this time, for <em>Chart Type</em> select <strong>Line</strong>. In the Encode tab, for the <em>X-Axis</em> select <code>timestamp</code> and turn on Binning, selecting <em>Hour</em> from the dropdown. For the <em>Y-Axis</em> select <code>temperature_fahrenheit</code>, and under the Aggregate dropdown select <em>Mean</em>. The combination of these two settings will combine all of an hour&rsquo;s readings into one group and take the average to represent that hour on the line chart. Finally, under <em>Series</em> we can select <code>sensorId</code> under <code>metadata</code>. While we only have one sensor currently, if we add more sensors in the future, this will show different lines for each sensor.</p><p>Now on the Filter tab, drag <code>timestamp</code> in as the filter and select <em>Period</em>, <em>Previous</em>, and <em>3 Day</em> to limit the chart to only consider the previous three days worth of data. Again, you can adjust this period up or down to suit your needs.</p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt="Visualization of the Hourly Change in Temperature" width=1919 height=1201 src=/posts/tracking-temperature-and-humidity-at-home-with-time-series-data/images/changeintemp_hu_eecf65118ade7e03.png srcset="/posts/tracking-temperature-and-humidity-at-home-with-time-series-data/images/changeintemp_hu_eecf65118ade7e03.png 800w, /posts/tracking-temperature-and-humidity-at-home-with-time-series-data/images/changeintemp_hu_5f1c44e492aa8b85.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/posts/tracking-temperature-and-humidity-at-home-with-time-series-data/images/changeintemp.png></figure><p>If you save and close, you&rsquo;ll have a nice dashboard of three charts showing you some basic temperature inforamtion from your sensor. As your sensor continues writing data, the line chart will become more useful as well. You can repeat this process to create three charts with the humidity data as well to give you a full representation of readings from the sensor.</p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt="The Complete Dashboard of Temperature and Humidity Data" width=1793 height=933 src=/posts/tracking-temperature-and-humidity-at-home-with-time-series-data/images/completedashboard_hu_144dd5a740585992.png srcset="/posts/tracking-temperature-and-humidity-at-home-with-time-series-data/images/completedashboard_hu_144dd5a740585992.png 800w, /posts/tracking-temperature-and-humidity-at-home-with-time-series-data/images/completedashboard_hu_581d1e3c1a064016.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/posts/tracking-temperature-and-humidity-at-home-with-time-series-data/images/completedashboard.png></figure></div></div><script type=text/javascript src=/js/page.min.54b6f4371722649edbe871e431d8670d670878c22be8f36e229fe53cc9b786fe25a834def5e6de621f7a3e37b72bc8cd73839aa5ed907ed6cbd45cd3e1b0fa20.js integrity="sha512-VLb0NxciZJ7b6HHkMdhnDWcIeMIr6PNuIp/lPMm3hv4lqDTe9ebeYh96Pje3K8jNc4Oape2QftbL1FzT4bD6IA==" data-oid=views_posts/2022-05-30/index.md data-oid-likes=likes_posts/2022-05-30/index.md></script></section><footer class="pt-8 max-w-prose print:hidden"><div class=pt-8><hr class="border-dotted border-neutral-300 dark:border-neutral-600"><div class="flex justify-between pt-3"><span class="flex flex-col"><a class="flex text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" href=/posts/building-event-driven-experiences-with-mongodb-realm-and-aws/><span class=leading-6><span class="inline-block rtl:rotate-180">&larr;</span>&ensp;Building Event Driven Experiences with MongoDB Realm and AWS
</span></a><span class="ms-6 mt-1 text-xs text-neutral-500 dark:text-neutral-400"><time datetime=2022-03-20T00:00:00+00:00>20 March 2022</time>
</span></span><span class="flex flex-col items-end"><a class="flex text-right text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" href=/posts/mongodb-world-2022-talk-look-ma-no-public-ip/><span class=leading-6>MongoDB World 2022 Talk: Look Ma, No Public IP!&ensp;<span class="inline-block rtl:rotate-180">&rarr;</span>
</span></a><span class="me-6 mt-1 text-xs text-neutral-500 dark:text-neutral-400"><time datetime=2022-08-16T00:00:00+00:00>16 August 2022</time></span></span></div></div></footer></article><div id=scroll-to-top class="fixed bottom-6 end-6 z-50 transform translate-y-4 opacity-0 duration-200"><a href=#the-top class="pointer-events-auto flex h-12 w-12 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400" aria-label="Scroll to top" title="Scroll to top">&uarr;</a></div></main><footer id=site-footer class="py-10 print:hidden"><nav class="flex flex-row pb-4 text-base font-medium text-neutral-500 dark:text-neutral-400 overflow-x-auto py-2"><ul class="flex list-none flex-row"><li class="flex mb-1 text-end sm:mb-0 sm:me-7 sm:last:me-0 me-4"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center" href title></a></li></ul></nav><div class="flex items-center justify-between"><p class="text-sm text-neutral-500 dark:text-neutral-400">&copy;
2025
John Misczak</p><p class="text-xs text-neutral-500 dark:text-neutral-400">Powered by <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://gohugo.io/ target=_blank rel="noopener noreferrer">Hugo</a> & <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://blowfish.page/ target=_blank rel="noopener noreferrer">Blowfish</a></p></div><script>mediumZoom(document.querySelectorAll("img:not(.nozoom)"),{margin:24,background:"rgba(0,0,0,0.5)",scrollOffset:0})</script><script type=text/javascript src=/js/process.min.ee03488f19c93c2efb199e2e3014ea5f3cb2ce7d45154adb3399a158cac27ca52831db249ede5bb602700ef87eb02434139de0858af1818ab0fb4182472204a4.js integrity="sha512-7gNIjxnJPC77GZ4uMBTqXzyyzn1FFUrbM5mhWMrCfKUoMdsknt5btgJwDvh+sCQ0E53ghYrxgYqw+0GCRyIEpA=="></script></footer><div id=search-wrapper class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh] z-500" data-url=https://www.misczak.com/><div id=search-modal class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800"><header class="relative z-10 flex items-center justify-between flex-none px-2"><form class="flex items-center flex-auto min-w-0"><div class="flex items-center justify-center w-8 h-8 text-neutral-400"><span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></div><input type=search id=search-query class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent" placeholder=Search tabindex=0></form><button id=close-search-button class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" title="Close (Esc)">
<span class="relative block icon"><svg viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></button></header><section class="flex-auto px-2 overflow-auto"><ul id=search-results></ul></section></div></div></div></body></html>